services:
    laravel-server:
        name: Akaunting Application Server
        description: Akaunting Laravel application server
        triggeredBy:
            - manual
        commands:
            start: php artisan serve --host=0.0.0.0 --port=8000
            ready: curl http://localhost:8000 -s -f -o /dev/null

    queue-worker:
        name: Laravel Queue Worker
        description: Process background jobs for Akaunting
        triggeredBy:
            - manual
        commands:
            start: php artisan queue:work --verbose --tries=3 --timeout=90
            stop: pkill -f "artisan queue:work"

    npm-dev:
        name: NPM Development Server
        description: Frontend asset compilation with hot reload
        triggeredBy:
            - manual
        commands:
            start: npm run dev
            ready: curl http://localhost:5173 -s -f -o /dev/null

tasks:
    install-dependencies:
        name: Install Dependencies
        description: Install Composer and NPM dependencies
        triggeredBy:
            - postDevcontainerStart
        command: |
            echo "ðŸ“¦ Installing dependencies..."
            
            # Install Composer dependencies
            composer install --no-dev --optimize-autoloader
            echo "âœ… Composer dependencies installed"
            
            # Install NPM dependencies
            npm install
            echo "âœ… NPM dependencies installed"
            
            # Build frontend assets
            npm run dev
            echo "âœ… Frontend assets built"

    install-akaunting:
        name: Install Akaunting
        description: Complete Akaunting installation using artisan install command
        triggeredBy:
            - manual
        dependsOn:
            - install-dependencies
        command: |
            echo "ðŸš€ Installing Akaunting..."
            
            # Wait for database to be ready
            echo "â³ Waiting for database connection..."
            until mysqladmin ping -h 127.0.0.1 -u root -ppass > /dev/null 2>&1; do
                sleep 2
                echo "Still waiting for database..."
            done
            echo "âœ… Database is ready"
            
            # Run Akaunting installation
            php artisan install \
                --db-name="akaunting" \
                --db-username="root" \
                --db-password="pass" \
                --admin-email="admin@company.com" \
                --admin-password="123456"
            
            echo "âœ… Akaunting installation completed!"
            echo "ðŸŽ‰ You can now access Akaunting at http://localhost:8000"
            echo "ðŸ“§ Admin email: admin@company.com"
            echo "ðŸ”‘ Admin password: 123456"

    # ... rest of your tasks remain the same